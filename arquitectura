â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    USUARIOS (HTTP/HTTPS)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     NGINX (Proxy Reverso)                    â”‚
â”‚  - Puerto 80 (HTTP)                                          â”‚
â”‚  - WebSocket support para Dash callbacks                    â”‚
â”‚  - Timeout: 300s para queries largas                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              GUNICORN (WSGI Server) - Puerto 8050            â”‚
â”‚  - 6 Workers (procesos Python)                              â”‚
â”‚  - Worker class: gthread (3 threads/worker = 18 threads)    â”‚
â”‚  - Max requests: 1000 + jitter 50 (reciclaje de workers)   â”‚
â”‚  - Timeout: 300s                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   DASH/PLOTLY (Framework)                    â”‚
â”‚  - Framework: Dash 2.17.1 + Plotly 5.17.0                  â”‚
â”‚  - 22 MÃ³dulos de pÃ¡ginas Python                             â”‚
â”‚  - Multi-page routing con callbacks                         â”‚
â”‚  - Bootstrap components (dbc 1.5.0)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   SQLite DATABASE    â”‚  â”‚    API XM (pydataxm 2.1.1)     â”‚
â”‚  portal_energetico.dbâ”‚  â”‚  - API Operador del Sistema    â”‚
â”‚  TamaÃ±o: 6.7 GB      â”‚  â”‚  - Datos en tiempo real        â”‚
â”‚  1.76M registros     â”‚  â”‚  - Consultas automÃ¡ticas       â”‚
â”‚  93 mÃ©tricas Ãºnicas  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… Portada (index_simple_working.py)
âœ… GeneraciÃ³n - Vista general
âœ… GeneraciÃ³n - Por fuentes (unificado)
âœ… GeneraciÃ³n - HidrÃ¡ulica/HidrologÃ­a
âœ… TransmisiÃ³n
âœ… DistribuciÃ³n - Demanda (unificado)
âœ… PÃ©rdidas (tÃ©cnicas + comerciales)
âœ… Restricciones operativas
âœ… ComercializaciÃ³n
âœ… MÃ©tricas avanzadas

Componentes Integrados:
ğŸ¤– Chat IA flotante (componentes/chat_ia.py)
ğŸ“Š Componentes reutilizables (pages/components.py)
ğŸ¨ Assets CSS/JS corporativos MME

ğŸ“Š Archivo: portal_energetico.db
ğŸ“¦ TamaÃ±o: 6.7 GB (6,795.13 MB)
ğŸ“ˆ Total registros: 1,768,018
ğŸ·ï¸ MÃ©tricas Ãºnicas: 93

ğŸ“… Rango temporal: 2020-01-01 â†’ 2026-01-25
âš ï¸  Datos desactualizados: 4 dÃ­as (Ãºltima actualizaciÃ³n: 2026-01-24)

Tablas del Sistema:
metrics - Datos agregados diarios

1.76M registros
Columnas: fecha, metrica, entidad, recurso, valor_gwh, unidad
Ãndice Ãºnico: (fecha, metrica, entidad, recurso)
metrics_hourly - Datos horarios

Para anÃ¡lisis granular de demanda/generaciÃ³n
24 horas por dÃ­a
catalogos - CatÃ¡logos de referencia

Embalses, recursos, regiones
Metadata adicional
predictions - Predicciones ML

Forecasting a 90 dÃ­as
Modelos Prophet + SARIMA
sqlite_sequence - Secuencias de autoincremento

Arquitectura ETL:
API XM â†’ ETL Python â†’ SQLite â†’ Dashboard Dash
   â†“          â†“         â†“           â†“
 Tiempo    ConversiÃ³n  Cache    VisualizaciÃ³n
  Real     Unidades   Local      Interactiva


 SISTEMA DE INTELIGENCIA ARTIFICIAL
Chatbot IA - Analista EnergÃ©tico
UbicaciÃ³n: chat_ia.py + ai_agent.py

TecnologÃ­a:
Prioridad 1: GROQ API â†’ Llama 3.3 70B Versatile
  - Latencia: ~98ms promedio
  - Rate limit: 30 req/min
  - Costo: $0 (API gratuita)
  - Hardware: LPU (Language Processing Units)

Prioridad 2: OpenRouter â†’ DeepSeek R1T2 Chimera
  - Fallback automÃ¡tico si GROQ falla
  - Rate limit: 50 req/dÃ­a (versiÃ³n free)

  âœ… AnÃ¡lisis de demanda elÃ©ctrica en tiempo real
âœ… AnÃ¡lisis de generaciÃ³n por fuentes
âœ… DetecciÃ³n de anomalÃ­as en mÃ©tricas
âœ… Consultas SQL automÃ¡ticas a base de datos
âœ… Contexto por pÃ¡gina (anÃ¡lisis inteligente segÃºn mÃ³dulo activo)
âœ… Respuestas en espaÃ±ol tÃ©cnico especializado

SISTEMA DE MACHINE LEARNING (PREDICCIONES)

ğŸ“ˆ ENSEMBLE Prophet + SARIMA
â”œâ”€â”€ Prophet (Meta AI)
â”‚   â””â”€â”€ Componentes: Tendencia + Estacionalidad + Eventos
â”œâ”€â”€ SARIMA (EstadÃ­stico)
â”‚   â””â”€â”€ ParÃ¡metros: (p,d,q)(P,D,Q,s)
â””â”€â”€ CombinaciÃ³n ponderada por MAPE

# Script: setup_auto_retrain.sh
Reentrenamiento: Domingos 00:00
ValidaciÃ³n automÃ¡tica post-entrenamiento
Logs de precisiÃ³n por fuente energÃ©tica

INFRAESTRUCTURA DE SERVIDOR

ğŸ’» CPU: Multi-core
ğŸ§  RAM: 15 GB total
   â”œâ”€â”€ Usado: 6.7 GB (45%)
   â”œâ”€â”€ Libre: 761 MB
   â”œâ”€â”€ Cache: 8.5 GB
   â””â”€â”€ Disponible: 8.9 GB

ğŸ’¾ Disco: 87 GB total
   â”œâ”€â”€ Usado: 42 GB (51%)
   â””â”€â”€ Disponible: 41 GB

ğŸ’¿ Swap: 3.8 GB (137 MB en uso)

ğŸ¨ Frontend/VisualizaciÃ³n:
â”œâ”€â”€ dash==2.17.1
â”œâ”€â”€ plotly==5.17.0
â”œâ”€â”€ dash-bootstrap-components==1.5.0
â””â”€â”€ pandas==2.2.2

ğŸ”Œ APIs y Datos:
â”œâ”€â”€ pydataxm==2.1.1 (API XM)
â”œâ”€â”€ requests==2.31.0
â””â”€â”€ geopy==2.4.1

ğŸ—„ï¸ Base de Datos:
â”œâ”€â”€ sqlalchemy==2.0.23
â”œâ”€â”€ psycopg2-binary==2.9.9 (PostgreSQL legacy)
â””â”€â”€ python-dotenv==1.0.0

ğŸ¤– Inteligencia Artificial:
â”œâ”€â”€ openai==2.9.0 (cliente OpenAI-compatible)
â””â”€â”€ Compatible con GROQ y OpenRouter

ğŸ“ˆ Machine Learning:
â”œâ”€â”€ prophet==1.1.6
â”œâ”€â”€ pmdarima==2.0.4
â”œâ”€â”€ statsmodels==0.14.4
â””â”€â”€ scikit-learn==1.5.2

ğŸš€ Servidor:
â”œâ”€â”€ gunicorn==21.2.0
â”œâ”€â”€ flask==3.0.0
â””â”€â”€ psutil==5.9.8 (monitoreo)


server/
â”œâ”€â”€ app.py                    # AplicaciÃ³n principal Dash
â”œâ”€â”€ gunicorn_config.py        # ConfiguraciÃ³n Gunicorn
â”œâ”€â”€ requirements.txt          # Dependencias Python
â”œâ”€â”€ .env                      # Variables de entorno (IA, BD)
â”‚
â”œâ”€â”€ pages/                    # 22 mÃ³dulos de pÃ¡ginas
â”‚   â”œâ”€â”€ index_simple_working.py
â”‚   â”œâ”€â”€ generacion.py
â”‚   â”œâ”€â”€ generacion_fuentes_unificado.py
â”‚   â”œâ”€â”€ generacion_hidraulica_hidrologia.py
â”‚   â”œâ”€â”€ transmision.py
â”‚   â”œâ”€â”€ distribucion_demanda_unificado.py
â”‚   â”œâ”€â”€ perdidas.py
â”‚   â”œâ”€â”€ restricciones.py
â”‚   â”œâ”€â”€ comercializacion.py
â”‚   â””â”€â”€ metricas.py
â”‚
â”œâ”€â”€ componentes/              # Componentes reutilizables
â”‚   â””â”€â”€ chat_ia.py           # Chatbot IA flotante
â”‚
â”œâ”€â”€ etl/                      # Sistema ETL
â”‚   â”œâ”€â”€ etl_xm_to_sqlite.py  # ETL principal
â”‚   â”œâ”€â”€ config_metricas.py   # 93 mÃ©tricas configuradas
â”‚   â””â”€â”€ validaciones.py      # ValidaciÃ³n post-ETL
â”‚
â”œâ”€â”€ utils/                    # Utilidades
â”‚   â”œâ”€â”€ ai_agent.py          # Agente IA (Llama 3.3 70B)
â”‚   â”œâ”€â”€ db_manager.py        # Gestor SQLite
â”‚   â”œâ”€â”€ health_check.py      # Health check endpoint
â”‚   â”œâ”€â”€ logger.py            # Sistema de logging
â”‚   â””â”€â”€ _xm.py               # Cliente API XM
â”‚
â”œâ”€â”€ assets/                   # CSS/JS/ImÃ¡genes
â”‚   â”œâ”€â”€ mme-corporate.css
â”‚   â”œâ”€â”€ professional-style.css
â”‚   â””â”€â”€ images/
â”‚
â”œâ”€â”€ docs/                     # DocumentaciÃ³n
â”‚   â”œâ”€â”€ DOCUMENTACION_TECNICA_IA_ML.md
â”‚   â”œâ”€â”€ INFORME_DICIEMBRE_2025.md
â”‚   â””â”€â”€ README.md
â”‚
â”œâ”€â”€ logs/                     # Logs del sistema
â”‚   â”œâ”€â”€ dashboard.log
â”‚   â”œâ”€â”€ etl_diario_*.log
â”‚   â””â”€â”€ validacion_*.log
â”‚
â”œâ”€â”€ portal_energetico.db      # Base de datos SQLite (6.7 GB)
â”‚
â””â”€â”€ scripts/                  # Scripts de utilidad
    â”œâ”€â”€ setup_auto_retrain.sh
    â””â”€â”€ validar_post_etl.sh


    